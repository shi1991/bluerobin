{"version":3,"sources":["services/proxy.babel.js"],"names":[],"mappings":"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","file":"services/proxy.babel.js","sourcesContent":["import Tool from './tool.babel.js';\r\n\r\nwindow.CONFIG = {\r\n  // APIROOT: 'http://localhost:1234/api'\r\n    APIROOT: 'http://zhanglun.daoapp.io/api'\r\n};\r\n\r\nlet CONFIG = window.CONFIG;\r\nlet root = CONFIG.APIROOT;\r\nlet proxy = {};\r\n\r\nCONFIG.API = {\r\n  TASKS: root + '/tasks',\r\n};\r\nproxy.Task = {};\r\nproxy.User = {};\r\nproxy.Upload = {};\r\n\r\n\r\n\r\n/**\r\n * 获取task\r\n * @param  {[type]} params querystring\r\n * @return {[type]}        [description]\r\n */\r\nproxy.Task.get = function(id) {\r\n  var url = CONFIG.API.TASKS;\r\n  if (id) {\r\n    url = CONFIG.API.TASKS + '/' + id;\r\n  }\r\n  return $.ajax({\r\n    method: 'get',\r\n    url: url,\r\n    headers: {\r\n      'x-access-token': localStorage.token\r\n    }\r\n  }).then(function(res) {\r\n    res.map(function(task) {\r\n      task.attachments.map(function(attachment) {\r\n        attachment.previewUrl = Tool.createImagePreviewUrl(attachment.url, 160, 80);\r\n      });\r\n    });\r\n    return res;\r\n  });\r\n};\r\n\r\n/**\r\n * 创建 task\r\n * @param  {[type]} task [description]\r\n * @return {[type]}      [description]\r\n */\r\nproxy.Task.create = function(task) {\r\n  return $.ajax({\r\n    method: 'post',\r\n    url: CONFIG.API.TASKS,\r\n    data: task,\r\n    headers: {\r\n      'x-access-token': localStorage.token\r\n    }\r\n  }).then(function(res) {\r\n    return res;\r\n  });\r\n\r\n};\r\n\r\n/**\r\n * 删除 task\r\n * @param  {[type]} task [description]\r\n * @return {[type]}      [description]\r\n */\r\nproxy.Task.delete = function(task) {\r\n  return $.ajax({\r\n    method: 'delete',\r\n    url: CONFIG.API.TASKS + '/' + task.id\r\n  }).then(function(res) {\r\n    return JSON.parse(res);\r\n  });\r\n};\r\n\r\n/**\r\n * [modify description]\r\n * @param  {[type]} task [description]\r\n * @return {[type]}      [description]\r\n */\r\nproxy.Task.edit = function(task) {\r\n  return $.ajax({\r\n      url: root + '/tasks/' + task.id,\r\n      method: 'put',\r\n      data: task,\r\n      dataType: 'json'\r\n    })\r\n    .done(function(res) {\r\n      return res;\r\n    })\r\n    .fail(function(xhr) {\r\n      return xhr;\r\n    });\r\n};\r\n\r\n\r\nproxy.User.login = function(user) {\r\n  return $.ajax({\r\n    method: 'post',\r\n    url: root + '/user/login',\r\n    data: user\r\n  });\r\n};\r\n\r\nproxy.User.signUp = function(user) {\r\n  return $.ajax({\r\n    type: 'post',\r\n    url: root + '/user/signup',\r\n    data: user,\r\n    dataType: 'json'\r\n  });\r\n};\r\n\r\nproxy.User.authenticate = function() {\r\n  return $.ajax({\r\n    method: 'post',\r\n    url: root + '/user/authenticate',\r\n    dataType: 'json',\r\n    headers: {\r\n      'x-access-token': localStorage.token\r\n    }\r\n  });\r\n};\r\n\r\n/**\r\n * 获取上传token\r\n * @return {[type]} [description]\r\n */\r\nproxy.Upload.getUptoken = function() {\r\n  return $.ajax({\r\n      method: 'get'\r\n    })\r\n    .done(function(res) {\r\n      return res;\r\n    });\r\n};\r\n\r\nexport default proxy;\r\n"],"sourceRoot":"/source/"}