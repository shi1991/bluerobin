{"version":3,"sources":["services/proxy.babel.js"],"names":[],"mappings":"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","file":"services/proxy.babel.js","sourcesContent":["import $ajax from './ajax.babel.js';\n\nwindow.CONFIG = {\n    APIROOT: 'http://127.0.0.1:1234/api'\n    // APIROOT: 'http://zhanglun.daoapp.io/api'\n};\n\nlet root = window.CONFIG.APIROOT;\n\nfunction JSON2FormData(json) {\n\n  var str = '';\n  for (var key in json) {\n    if (str !== '') {\n      str += '&';\n    }\n    str += key + '=' + encodeURIComponent(json[key]);\n  }\n  return str;\n}\n\n\nlet proxy = {};\nproxy.Task = {};\nproxy.User = {};\nproxy.Upload = {};\n\nwindow.CONFIG.API = {\n  TASKS: root + '/tasks',\n};\n\n/**\n * 获取task\n * @param  {[type]} params querystring\n * @return {[type]}        [description]\n */\nproxy.Task.get = function(params) {\n  return $ajax.get({\n    url: CONFIG.API.TASKS,\n    data: params,\n    token: localStorage.token\n  }).then(function(res) {\n    return JSON.parse(res);\n  });\n};\n\n/**\n * 创建 task\n * @param  {[type]} task [description]\n * @return {[type]}      [description]\n */\nproxy.Task.create = function(task) {\n  return $ajax.post({\n    url: CONFIG.API.TASKS,\n    data: task,\n    token: localStorage.token\n  }).then(function(res) {\n    return JSON.parse(res);\n  });\n\n};\n\n/**\n * 删除 task\n * @param  {[type]} task [description]\n * @return {[type]}      [description]\n */\nproxy.Task.delete = function(task) {\n  return $ajax.delete({\n    url: CONFIG.API.TASKS + '/' + task._id\n  }).then(function(res) {\n    return JSON.parse(res);\n  });\n};\n\n/**\n * [modify description]\n * @param  {[type]} task [description]\n * @return {[type]}      [description]\n */\nproxy.Task.edit = function(task) {\n  return $.ajax({\n    url: root + '/tasks/' + task._id,\n    method: 'put',\n    data: task,\n    dataType: 'json'\n  })\n  .done(function(res){\n    return res;\n  })\n  .fail(function(xhr){\n    return xhr;\n  });\n};\n\n\nproxy.User.login = function(user) {\n  return $ajax.post({\n    url: root + '/user/login',\n    data: user\n  }).then(function(res) {\n    return JSON.parse(res);\n  });\n};\n\n\nproxy.User.authenticate = function(user){\n  return $.ajax({\n    method: 'post',\n    url: root + '/user/authenticate',\n    dataType: 'json',\n    headers: {\n      'x-access-token': localStorage.token\n    }\n  })\n};\n\n/**\n * 获取上传token\n * @return {[type]} [description]\n */\nproxy.Upload.getUptoken = function() {\n  return fetch(root + '/qiniu/token', {\n      method: 'get'\n    })\n    .then(function(res) {\n      if (res.ok) {\n        return res.json();\n      }\n    });\n};\n\nwindow.$ajax = $ajax;\nwindow.$get = $ajax.get;\n\n\nexport default proxy;\n"],"sourceRoot":"/source/"}